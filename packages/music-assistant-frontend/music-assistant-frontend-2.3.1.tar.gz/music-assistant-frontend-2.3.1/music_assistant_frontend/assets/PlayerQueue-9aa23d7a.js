import{v as ee,Q as te,aa as le,r as V,c as $,o as ue,L as s,ak as A,b as ne,w as ae,y as i,E as B,l as t,A as u,R as g,N as d,x as _,z as m,I as f,n as oe,F as ie,G as re,B as w,H as M,J as D,K as L,a3 as se,M as de}from"./index-20675090.js";import{L as me}from"./ListviewItem-ea07a19b.js";import{B as pe,L as c}from"./ListItem-e092a77b.js";import{C as ve}from"./Container-e8fef44d.js";import{A as H}from"./Alert-daf9024b.js";import{V as N}from"./VBadge-778cac01.js";import{a as J,V as fe}from"./VTabs-e5aaec44.js";import{k as y,j as T,V as C}from"./forwardRefs-67412654.js";import{b as O,e as _e,d as b}from"./VMenu-ae4158ef.js";import{V as W,a as X}from"./VToolbar-7174c765.js";import{V as ce}from"./VVirtualScroll-b47ffb64.js";import{V as ge}from"./VCard-30020028.js";import{V as ye}from"./VCardText-5e149cd1.js";import{V as be}from"./VDialog-d7f48b87.js";import"./VTooltip-cf009865.js";import"./VCheckboxBtn-bbfa74a1.js";import"./VSlideGroup-14bb6bf6.js";/* empty css              */const qe=w("br",null,null,-1),ke={key:0},Ke=ee({__name:"PlayerQueue",setup(Ce){const{t:Y}=te(),S=le(),E=V(0),r=V(),h=V(!1),I=V([]),q=V([]),e=$(()=>{if(D.selectedPlayer)return s.queues[D.selectedPlayer.active_source]}),Z=$(()=>{if(e.value)return e.value.current_item}),U=$(()=>e.value?q.value.slice(e.value.current_index):[]),R=$(()=>e.value?q.value.slice(0,e.value.current_index):[]),Q=$(()=>E.value==1?R.value:U.value);ue(()=>{const l=s.subscribe_multi([A.QUEUE_UPDATED,A.QUEUE_ITEMS_UPDATED],n=>{var a;n.object_id==((a=e.value)==null?void 0:a.queue_id)&&(n.event==A.QUEUE_ITEMS_UPDATED?j():P())});ne(l)});const j=async function(){e.value?(q.value=[],await s.getPlayerQueueItems(e.value.queue_id,l=>{q.value.push(...l)})):q.value=[]},F=function(l){r.value=l,h.value=!0},K=function(l){x(),S.push({name:l.media_type,params:{itemId:l.item_id,provider:l.provider}})},k=function(l,n){x(),!(!l||!e.value)&&(n=="play_now"?s.queueCommandPlayIndex(e==null?void 0:e.value.queue_id,l.queue_item_id):n=="move_next"?s.queueCommandMoveNext(e==null?void 0:e.value.queue_id,l.queue_item_id):n=="up"?s.queueCommandMoveUp(e==null?void 0:e.value.queue_id,l.queue_item_id):n=="down"?s.queueCommandMoveDown(e==null?void 0:e.value.queue_id,l.queue_item_id):n=="delete"&&s.queueCommandDelete(e==null?void 0:e.value.queue_id,l.queue_item_id))},P=function(){I.value=[{label:"settings.player_settings",labelArgs:[],action:()=>{S.push(`/settings/editplayer/${e.value.queue_id}`)},icon:"mdi-cog-outline"},{label:"queue_clear",labelArgs:[],action:()=>{s.queueCommandClear(e.value.queue_id)},icon:"mdi-cancel"},{label:e.value.shuffle_enabled?"shuffle_enabled":"shuffle_disabled",labelArgs:[],action:()=>{s.queueCommandShuffleToggle(e.value.queue_id)},icon:e.value.shuffle_enabled?"mdi-shuffle":"mdi-shuffle-disabled"},{label:"repeat_mode",labelArgs:[Y(`repeatmode.${e.value.repeat_mode}`)],action:()=>{s.queueCommandRepeatToggle(e.value.queue_id)},icon:e.value.shuffle_enabled?"mdi-repeat":"mdi-repeat-off"}]},x=function(){r.value=void 0,h.value=!1};return ae(()=>e.value,l=>{l&&(j(),P())},{immediate:!0}),(l,n)=>(i(),B("section",null,[t(W,{variant:"flat",color:"transparent",style:{height:"50px"}},{title:u(()=>{var a;return[g(d(l.$t("queue"))+" | "+d((a=_(D).selectedPlayer)==null?void 0:a.display_name)+" ",1),_(L)("bp6")?f("",!0):(i(),m(N,{key:0,color:"grey",content:U.value.length,inline:""},null,8,["content"]))]}),append:u(()=>[_(L)("bp6")?(i(),m(fe,{key:0,modelValue:E.value,"onUpdate:modelValue":n[0]||(n[0]=a=>E.value=a),"show-arrows":"",grow:""},{default:u(()=>[t(J,{value:0},{default:u(()=>[g(d(l.$t("queue_next_items"))+" ",1),t(N,{color:"grey",content:U.value.length,inline:""},null,8,["content"])]),_:1}),t(J,{value:1},{default:u(()=>[g(d(l.$t("queue_previous_items"))+" ",1),t(N,{color:"grey",content:R.value.length,inline:""},null,8,["content"])]),_:1})]),_:1},8,["modelValue"])):f("",!0),I.value&&I.value.length>0?(i(),m(_e,{key:1,location:"bottom end"},{activator:u(({props:a})=>[t(pe,oe({icon:"",style:{right:"3px"}},a),{default:u(()=>[t(y,{icon:"mdi-dots-vertical"})]),_:2},1040)]),default:u(()=>[t(O,null,{default:u(()=>[(i(!0),B(ie,null,re(I.value.filter(a=>a.hide!=!0),(a,o)=>(i(),m(c,{key:o,title:l.$t(a.label,a.labelArgs),disabled:a.disabled==!0,onClick:p=>a.action?a.action():""},{prepend:u(()=>[t(b,{icon:a.icon},null,8,["icon"])]),_:2},1032,["title","disabled","onClick"]))),128))]),_:1})]),_:1})):f("",!0)]),_:1}),t(ve,null,{default:u(()=>{var a;return[e.value&&((a=e.value)==null?void 0:a.radio_source.length)>0?(i(),m(H,{key:0,icon:"mdi-radio-tower"},{default:u(()=>{var o,p,v,z;return[w("b",null,d(l.$t("queue_radio_enabled")),1),qe,g(" "+d(l.$t("queue_radio_based_on",[l.$t((o=e.value)==null?void 0:o.radio_source[0].media_type)]))+" ",1),w("b",null,[w("a",{onClick:n[1]||(n[1]=we=>{var G;return e.value?K((G=e.value)==null?void 0:G.radio_source[0]):""})},d((p=e.value)==null?void 0:p.radio_source[0].name),1)]),((v=e.value)==null?void 0:v.radio_source.length)>1?(i(),B("span",ke," (+"+d(((z=e.value)==null?void 0:z.radio_source.length)-1)+")",1)):f("",!0)]}),_:1})):f("",!0),t(ce,{height:66,items:Q.value,style:{height:"100%"}},{default:u(({item:o})=>{var p;return[o.media_item?(i(),m(me,{key:o.queue_item_id,item:o.media_item||o,"show-disc-number":!1,"show-track-number":!1,"show-duration":!0,"show-library":!0,"show-menu":!0,"show-provider":!1,"show-album":!1,"show-checkboxes":!1,"is-selected":!1,"show-details":!1,"is-disabled":o.queue_item_id==((p=Z.value)==null?void 0:p.queue_item_id),ripple:"",onMenu:v=>F(o),onClick:v=>k(o,"play_now"),onContextmenu:M(v=>F(o),["right","prevent"])},{append:u(()=>[_(L)("bp1")?(i(),m(T,{key:0,variant:"plain",ripple:"",icon:"mdi-arrow-up",title:l.$t("queue_move_up"),onClick:[v=>_(s).queueCommandMoveUp(e.value.queue_id,o.queue_item_id),n[2]||(n[2]=M(()=>{},["prevent"])),n[3]||(n[3]=M(()=>{},["stop"]))]},null,8,["title","onClick"])):f("",!0),t(T,{icon:"mdi-arrow-down",title:l.$t("queue_move_down"),onClick:M(v=>_(s).queueCommandMoveDown(e.value.queue_id,o.queue_item_id),["prevent"])},null,8,["title","onClick"])]),_:2},1032,["item","is-disabled","onMenu","onClick","onContextmenu"])):(i(),m(c,{key:1},{title:u(()=>[g(d(o.name),1)]),_:2},1024))]}),_:1},8,["items"]),q.value.length==0?(i(),m(H,{key:1,type:"info"},{default:u(()=>[g(d(l.$t("no_content")),1)]),_:1})):f("",!0)]}),_:1}),t(be,{modelValue:h.value,"onUpdate:modelValue":n[11]||(n[11]=a=>h.value=a),fullscreen:l.$vuetify.display.mobile,"min-height":"80%",scrim:!0},{default:u(()=>[t(ge,null,{default:u(()=>[t(W,{sense:"",dark:"",color:"primary"},{default:u(()=>[t(T,{icon:"mdi-play-circle-outline"}),r.value?(i(),m(X,{key:0,style:{"padding-left":"10px"}},{default:u(()=>{var a;return[w("b",null,d(_(se)(((a=r.value)==null?void 0:a.name)||"",l.$vuetify.display.mobile?20:150)),1)]}),_:1})):(i(),m(X,{key:1,style:{"padding-left":"10px"}},{default:u(()=>{var a;return[w("b",null,d(l.$t("settings")),1),g(" | "+d((a=e.value)==null?void 0:a.display_name),1)]}),_:1})),t(T,{icon:"mdi-close",dark:"",onClick:n[4]||(n[4]=a=>x())})]),_:1}),r.value?(i(),m(ye,{key:0},{default:u(()=>[t(O,null,{default:u(()=>{var a,o;return[t(c,{title:l.$t("play_now"),onClick:n[5]||(n[5]=p=>k(r.value,"play_now"))},{prepend:u(()=>[t(b,{style:{"padding-right":"10px"}},{default:u(()=>[t(y,{icon:"mdi-play-circle-outline"})]),_:1})]),_:1},8,["title"]),t(C),t(c,{title:l.$t("play_next"),onClick:n[6]||(n[6]=p=>k(r.value,"move_next"))},{prepend:u(()=>[t(b,{style:{"padding-right":"10px"}},{default:u(()=>[t(y,{icon:"mdi-skip-next-circle-outline"})]),_:1})]),_:1},8,["title"]),t(C),t(c,{title:l.$t("queue_move_up"),onClick:n[7]||(n[7]=p=>k(r.value,"up"))},{prepend:u(()=>[t(b,{style:{"padding-right":"10px"}},{default:u(()=>[t(y,{icon:"mdi-arrow-up"})]),_:1})]),_:1},8,["title"]),t(C),t(c,{title:l.$t("queue_move_down"),onClick:n[8]||(n[8]=p=>k(r.value,"down"))},{prepend:u(()=>[t(b,{style:{"padding-right":"10px"}},{default:u(()=>[t(y,{icon:"mdi-arrow-down"})]),_:1})]),_:1},8,["title"]),t(C),t(c,{title:l.$t("queue_delete"),onClick:n[9]||(n[9]=p=>k(r.value,"delete"))},{prepend:u(()=>[t(b,{style:{"padding-right":"10px"}},{default:u(()=>[t(y,{icon:"mdi-delete"})]),_:1})]),_:1},8,["title"]),t(C),((o=(a=r.value)==null?void 0:a.media_item)==null?void 0:o.media_type)==_(de).TRACK?(i(),m(c,{key:0,title:l.$t("show_info"),onClick:n[10]||(n[10]=p=>{var v;return(v=r.value)!=null&&v.media_item?K(r.value.media_item):""})},{prepend:u(()=>[t(b,{style:{"padding-right":"10px"}},{default:u(()=>[t(y,{icon:"mdi-information-outline"})]),_:1})]),_:1},8,["title"])):f("",!0),t(C)]}),_:1})]),_:1})):f("",!0)]),_:1})]),_:1},8,["modelValue","fullscreen"])]))}});export{Ke as default};
