import{m as re,V as $}from"./VTextField-8bb22937.js";import{s as Y,w as H,p as G,aJ as ce,az as de,g as fe,aK as ve,r as B,h as q,c as w,aV as me,l as s,F as _,n as P,aX as pe,R as he,aY as ye,aZ as j}from"./index-20675090.js";import{j as Ve,c as ge,V as we}from"./VCheckboxBtn-bbfa74a1.js";import{I as ke,i as be,k as z,G as Ce,H as Pe}from"./forwardRefs-67412654.js";import{l as Se,k as xe,n as De,e as Te,b as Ie,V as W,d as Ae}from"./VMenu-ae4158ef.js";import{V as Re}from"./VVirtualScroll-b47ffb64.js";function Fe(e,L){const l=Y(!1);let p;function v(i){cancelAnimationFrame(p),l.value=!0,p=requestAnimationFrame(()=>{p=requestAnimationFrame(()=>{l.value=!1})})}async function x(){await new Promise(i=>requestAnimationFrame(i)),await new Promise(i=>requestAnimationFrame(i)),await new Promise(i=>requestAnimationFrame(i)),await new Promise(i=>{if(l.value){const a=H(l,()=>{a(),i()})}else i()})}async function D(i){var T,I;if(i.key==="Tab"&&((T=L.value)==null||T.focus()),!["PageDown","PageUp","Home","End"].includes(i.key))return;const a=(I=e.value)==null?void 0:I.$el;if(!a)return;(i.key==="Home"||i.key==="End")&&a.scrollTo({top:i.key==="Home"?0:a.scrollHeight,behavior:"smooth"}),await x();const h=a.querySelectorAll(":scope > :not(.v-virtual-scroll__spacer)");if(i.key==="PageDown"||i.key==="Home"){const u=a.getBoundingClientRect().top;for(const y of h)if(y.getBoundingClientRect().top>=u){y.focus();break}}else{const u=a.getBoundingClientRect().bottom;for(const y of[...h].reverse())if(y.getBoundingClientRect().bottom<=u){y.focus();break}}}return{onListScroll:v,onListKeydown:D}}const Be=G({chips:Boolean,closableChips:Boolean,closeText:{type:String,default:"$vuetify.close"},openText:{type:String,default:"$vuetify.open"},eager:Boolean,hideNoData:Boolean,hideSelected:Boolean,listProps:{type:Object},menu:Boolean,menuIcon:{type:ce,default:"$dropdown"},menuProps:{type:Object},multiple:Boolean,noDataText:{type:String,default:"$vuetify.noDataText"},openOnClear:Boolean,itemColor:String,...Se({itemChildren:!1})},"Select"),Le=G({...Be(),...de(re({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...ke({transition:{component:xe}})},"VSelect"),Ne=fe()({name:"VSelect",props:Le(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,L){let{slots:l}=L;const{t:p}=ve(),v=B(),x=B(),D=B(),i=q(e,"menu"),a=w({get:()=>i.value,set:t=>{var n;i.value&&!t&&((n=x.value)!=null&&n.Î¨openChildren)||(i.value=t)}}),{items:h,transformIn:T,transformOut:I}=De(e),u=q(e,"modelValue",[],t=>T(t===null?[null]:ye(t)),t=>{const n=I(t);return e.multiple?n:n[0]??null}),y=w(()=>typeof e.counterValue=="function"?e.counterValue(u.value):typeof e.counterValue=="number"?e.counterValue:u.value.length),k=Ve(),J=w(()=>u.value.map(t=>t.value)),V=Y(!1),K=w(()=>a.value?e.closeText:e.openText);let O="",E;const b=w(()=>e.hideSelected?h.value.filter(t=>!u.value.some(n=>n===t)):h.value),M=w(()=>e.hideNoData&&!b.value.length||e.readonly||(k==null?void 0:k.isReadonly.value)),X=w(()=>{var t;return{...e.menuProps,activatorProps:{...((t=e.menuProps)==null?void 0:t.activatorProps)||{},"aria-haspopup":"listbox"}}}),S=B(),{onListScroll:Z,onListKeydown:Q}=Fe(S,v);function ee(t){e.openOnClear&&(a.value=!0)}function te(){M.value||(a.value=!a.value)}function le(t){var o,f;if(!t.key||e.readonly||k!=null&&k.isReadonly.value)return;["Enter"," ","ArrowDown","ArrowUp","Home","End"].includes(t.key)&&t.preventDefault(),["Enter","ArrowDown"," "].includes(t.key)&&(a.value=!0),["Escape","Tab"].includes(t.key)&&(a.value=!1),t.key==="Home"?(o=S.value)==null||o.focus("first"):t.key==="End"&&((f=S.value)==null||f.focus("last"));const n=1e3;function c(r){const m=r.key.length===1,d=!r.ctrlKey&&!r.metaKey&&!r.altKey;return m&&d}if(e.multiple||!c(t))return;const R=performance.now();R-E>n&&(O=""),O+=t.key.toLowerCase(),E=R;const F=h.value.find(r=>r.title.toLowerCase().startsWith(O));F!==void 0&&(u.value=[F])}function A(t){if(e.multiple){const n=u.value.findIndex(c=>e.valueComparator(c.value,t.value));if(n===-1)u.value=[...u.value,t];else{const c=[...u.value];c.splice(n,1),u.value=c}}else u.value=[t],a.value=!1}function ne(t){var n;(n=S.value)!=null&&n.$el.contains(t.relatedTarget)||(a.value=!1)}function ae(){var t;V.value&&((t=v.value)==null||t.focus())}function oe(t){V.value=!0}function ue(t){if(t==null)u.value=[];else if(j(v.value,":autofill")||j(v.value,":-webkit-autofill")){const n=h.value.find(c=>c.title===t);n&&A(n)}else v.value&&(v.value.value="")}return H(a,()=>{if(!e.hideSelected&&a.value&&u.value.length){const t=b.value.findIndex(n=>u.value.some(c=>e.valueComparator(c.value,n.value)));me&&window.requestAnimationFrame(()=>{var n;t>=0&&((n=D.value)==null||n.scrollToIndex(t))})}}),H(b,(t,n)=>{V.value&&(!t.length&&e.hideNoData&&(a.value=!1),!n.length&&t.length&&(a.value=!0))}),be(()=>{const t=!!(e.chips||l.chip),n=!!(!e.hideNoData||b.value.length||l["prepend-item"]||l["append-item"]||l["no-data"]),c=u.value.length>0,R=$.filterProps(e),F=c||!V.value&&e.label&&!e.persistentPlaceholder?void 0:e.placeholder;return s($,P({ref:v},R,{modelValue:u.value.map(o=>o.props.value).join(", "),"onUpdate:modelValue":ue,focused:V.value,"onUpdate:focused":o=>V.value=o,validationValue:u.externalValue,counterValue:y.value,dirty:c,class:["v-select",{"v-select--active-menu":a.value,"v-select--chips":!!e.chips,[`v-select--${e.multiple?"multiple":"single"}`]:!0,"v-select--selected":u.value.length,"v-select--selection-slot":!!l.selection},e.class],style:e.style,inputmode:"none",placeholder:F,"onClick:clear":ee,"onMousedown:control":te,onBlur:ne,onKeydown:le,"aria-label":p(K.value),title:p(K.value)}),{...l,default:()=>s(_,null,[s(Te,P({ref:x,modelValue:a.value,"onUpdate:modelValue":o=>a.value=o,activator:"parent",contentClass:"v-select__content",disabled:M.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:ae},X.value),{default:()=>[n&&s(Ie,P({ref:S,selected:J.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:o=>o.preventDefault(),onKeydown:Q,onFocusin:oe,onScrollPassive:Z,tabindex:"-1","aria-live":"polite",color:e.itemColor??e.color},e.listProps),{default:()=>{var o,f,r;return[(o=l["prepend-item"])==null?void 0:o.call(l),!b.value.length&&!e.hideNoData&&(((f=l["no-data"])==null?void 0:f.call(l))??s(W,{title:p(e.noDataText)},null)),s(Re,{ref:D,renderless:!0,items:b.value},{default:m=>{var U;let{item:d,index:C,itemRef:g}=m;const N=P(d.props,{ref:g,key:C,onClick:()=>A(d)});return((U=l.item)==null?void 0:U.call(l,{item:d,index:C,props:N}))??s(W,P(N,{role:"option"}),{prepend:ie=>{let{isSelected:se}=ie;return s(_,null,[e.multiple&&!e.hideSelected?s(ge,{key:d.value,modelValue:se,ripple:!1,tabindex:"-1"},null):void 0,d.props.prependAvatar&&s(Ae,{image:d.props.prependAvatar},null),d.props.prependIcon&&s(z,{icon:d.props.prependIcon},null)])}})}}),(r=l["append-item"])==null?void 0:r.call(l)]}})]}),u.value.map((o,f)=>{function r(g){g.stopPropagation(),g.preventDefault(),A(o)}const m={"onClick:close":r,onMousedown(g){g.preventDefault(),g.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},d=t?!!l.chip:!!l.selection,C=d?pe(t?l.chip({item:o,index:f,props:m}):l.selection({item:o,index:f})):void 0;if(!(d&&!C))return s("div",{key:o.value,class:"v-select__selection"},[t?l.chip?s(Ce,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:o.title}}},{default:()=>[C]}):s(we,P({key:"chip",closable:e.closableChips,size:"small",text:o.title,disabled:o.props.disabled},m),null):C??s("span",{class:"v-select__selection-text"},[o.title,e.multiple&&f<u.value.length-1&&s("span",{class:"v-select__selection-comma"},[he(",")])])])})]),"append-inner":function(){var m;for(var o=arguments.length,f=new Array(o),r=0;r<o;r++)f[r]=arguments[r];return s(_,null,[(m=l["append-inner"])==null?void 0:m.call(l,...f),e.menuIcon?s(z,{class:"v-select__menu-icon",icon:e.menuIcon},null):void 0])}})}),Pe({isFocused:V,menu:a,select:A},v)}});export{Ne as V};
