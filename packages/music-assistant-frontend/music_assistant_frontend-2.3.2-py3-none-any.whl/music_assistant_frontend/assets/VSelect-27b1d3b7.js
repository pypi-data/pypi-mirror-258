import{m as re,V as $}from"./VTextField-ce4a0dcf.js";import{s as Y,w as E,p as Z,aK as ce,aA as de,g as fe,aL as ve,r as L,h as q,c as w,aW as me,l as s,F as O,n as P,aY as pe,R as he,aZ as ye,a_ as j}from"./index-4abadf84.js";import{j as ge,c as Ve,V as we}from"./VCheckboxBtn-c7727adb.js";import{I as ke,i as be,k as W,E as Ce,F as Pe}from"./forwardRefs-7da7908a.js";import{l as Se,k as xe,n as De,e as Te,b as Ae,V as z,d as Ie}from"./VMenu-5b409939.js";import{V as Fe}from"./VVirtualScroll-26a90d88.js";function Re(e,B){const l=Y(!1);let p;function v(i){cancelAnimationFrame(p),l.value=!0,p=requestAnimationFrame(()=>{p=requestAnimationFrame(()=>{l.value=!1})})}async function x(){await new Promise(i=>requestAnimationFrame(i)),await new Promise(i=>requestAnimationFrame(i)),await new Promise(i=>requestAnimationFrame(i)),await new Promise(i=>{if(l.value){const a=E(l,()=>{a(),i()})}else i()})}async function D(i){var T,A;if(i.key==="Tab"&&((T=B.value)==null||T.focus()),!["PageDown","PageUp","Home","End"].includes(i.key))return;const a=(A=e.value)==null?void 0:A.$el;if(!a)return;(i.key==="Home"||i.key==="End")&&a.scrollTo({top:i.key==="Home"?0:a.scrollHeight,behavior:"smooth"}),await x();const h=a.querySelectorAll(":scope > :not(.v-virtual-scroll__spacer)");if(i.key==="PageDown"||i.key==="Home"){const u=a.getBoundingClientRect().top;for(const y of h)if(y.getBoundingClientRect().top>=u){y.focus();break}}else{const u=a.getBoundingClientRect().bottom;for(const y of[...h].reverse())if(y.getBoundingClientRect().bottom<=u){y.focus();break}}}return{onListScroll:v,onListKeydown:D}}const Le=Z({chips:Boolean,closableChips:Boolean,closeText:{type:String,default:"$vuetify.close"},openText:{type:String,default:"$vuetify.open"},eager:Boolean,hideNoData:Boolean,hideSelected:Boolean,listProps:{type:Object},menu:Boolean,menuIcon:{type:ce,default:"$dropdown"},menuProps:{type:Object},multiple:Boolean,noDataText:{type:String,default:"$vuetify.noDataText"},openOnClear:Boolean,itemColor:String,...Se({itemChildren:!1})},"Select"),Be=Z({...Le(),...de(re({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...ke({transition:{component:xe}})},"VSelect"),Ne=fe()({name:"VSelect",props:Be(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,B){let{slots:l}=B;const{t:p}=ve(),v=L(),x=L(),D=L(),i=q(e,"menu"),a=w({get:()=>i.value,set:t=>{var n;i.value&&!t&&((n=x.value)!=null&&n.Î¨openChildren)||(i.value=t)}}),{items:h,transformIn:T,transformOut:A}=De(e),u=q(e,"modelValue",[],t=>T(t===null?[null]:ye(t)),t=>{const n=A(t);return e.multiple?n:n[0]??null}),y=w(()=>typeof e.counterValue=="function"?e.counterValue(u.value):typeof e.counterValue=="number"?e.counterValue:u.value.length),k=ge(),G=w(()=>u.value.map(t=>t.value)),g=Y(!1),K=w(()=>a.value?e.closeText:e.openText);let _="",H;const b=w(()=>e.hideSelected?h.value.filter(t=>!u.value.some(n=>n===t)):h.value),M=w(()=>e.hideNoData&&!b.value.length||e.readonly||(k==null?void 0:k.isReadonly.value)),J=w(()=>{var t;return{...e.menuProps,activatorProps:{...((t=e.menuProps)==null?void 0:t.activatorProps)||{},"aria-haspopup":"listbox"}}}),S=L(),{onListScroll:Q,onListKeydown:X}=Re(S,v);function ee(t){e.openOnClear&&(a.value=!0)}function te(){M.value||(a.value=!a.value)}function le(t){var o,f;if(!t.key||e.readonly||k!=null&&k.isReadonly.value)return;["Enter"," ","ArrowDown","ArrowUp","Home","End"].includes(t.key)&&t.preventDefault(),["Enter","ArrowDown"," "].includes(t.key)&&(a.value=!0),["Escape","Tab"].includes(t.key)&&(a.value=!1),t.key==="Home"?(o=S.value)==null||o.focus("first"):t.key==="End"&&((f=S.value)==null||f.focus("last"));const n=1e3;function c(r){const m=r.key.length===1,d=!r.ctrlKey&&!r.metaKey&&!r.altKey;return m&&d}if(e.multiple||!c(t))return;const F=performance.now();F-H>n&&(_=""),_+=t.key.toLowerCase(),H=F;const R=h.value.find(r=>r.title.toLowerCase().startsWith(_));R!==void 0&&(u.value=[R])}function I(t){if(e.multiple){const n=u.value.findIndex(c=>e.valueComparator(c.value,t.value));if(n===-1)u.value=[...u.value,t];else{const c=[...u.value];c.splice(n,1),u.value=c}}else u.value=[t],a.value=!1}function ne(t){var n;(n=S.value)!=null&&n.$el.contains(t.relatedTarget)||(a.value=!1)}function ae(){var t;g.value&&((t=v.value)==null||t.focus())}function oe(t){g.value=!0}function ue(t){if(t==null)u.value=[];else if(j(v.value,":autofill")||j(v.value,":-webkit-autofill")){const n=h.value.find(c=>c.title===t);n&&I(n)}else v.value&&(v.value.value="")}return E(a,()=>{if(!e.hideSelected&&a.value&&u.value.length){const t=b.value.findIndex(n=>u.value.some(c=>e.valueComparator(c.value,n.value)));me&&window.requestAnimationFrame(()=>{var n;t>=0&&((n=D.value)==null||n.scrollToIndex(t))})}}),E(b,(t,n)=>{g.value&&(!t.length&&e.hideNoData&&(a.value=!1),!n.length&&t.length&&(a.value=!0))}),be(()=>{const t=!!(e.chips||l.chip),n=!!(!e.hideNoData||b.value.length||l["prepend-item"]||l["append-item"]||l["no-data"]),c=u.value.length>0,F=$.filterProps(e),R=c||!g.value&&e.label&&!e.persistentPlaceholder?void 0:e.placeholder;return s($,P({ref:v},F,{modelValue:u.value.map(o=>o.props.value).join(", "),"onUpdate:modelValue":ue,focused:g.value,"onUpdate:focused":o=>g.value=o,validationValue:u.externalValue,counterValue:y.value,dirty:c,class:["v-select",{"v-select--active-menu":a.value,"v-select--chips":!!e.chips,[`v-select--${e.multiple?"multiple":"single"}`]:!0,"v-select--selected":u.value.length,"v-select--selection-slot":!!l.selection},e.class],style:e.style,inputmode:"none",placeholder:R,"onClick:clear":ee,"onMousedown:control":te,onBlur:ne,onKeydown:le,"aria-label":p(K.value),title:p(K.value)}),{...l,default:()=>s(O,null,[s(Te,P({ref:x,modelValue:a.value,"onUpdate:modelValue":o=>a.value=o,activator:"parent",contentClass:"v-select__content",disabled:M.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:ae},J.value),{default:()=>[n&&s(Ae,P({ref:S,selected:G.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:o=>o.preventDefault(),onKeydown:X,onFocusin:oe,onScrollPassive:Q,tabindex:"-1","aria-live":"polite",color:e.itemColor??e.color},e.listProps),{default:()=>{var o,f,r;return[(o=l["prepend-item"])==null?void 0:o.call(l),!b.value.length&&!e.hideNoData&&(((f=l["no-data"])==null?void 0:f.call(l))??s(z,{title:p(e.noDataText)},null)),s(Fe,{ref:D,renderless:!0,items:b.value},{default:m=>{var U;let{item:d,index:C,itemRef:V}=m;const N=P(d.props,{ref:V,key:C,onClick:()=>I(d)});return((U=l.item)==null?void 0:U.call(l,{item:d,index:C,props:N}))??s(z,P(N,{role:"option"}),{prepend:ie=>{let{isSelected:se}=ie;return s(O,null,[e.multiple&&!e.hideSelected?s(Ve,{key:d.value,modelValue:se,ripple:!1,tabindex:"-1"},null):void 0,d.props.prependAvatar&&s(Ie,{image:d.props.prependAvatar},null),d.props.prependIcon&&s(W,{icon:d.props.prependIcon},null)])}})}}),(r=l["append-item"])==null?void 0:r.call(l)]}})]}),u.value.map((o,f)=>{function r(V){V.stopPropagation(),V.preventDefault(),I(o)}const m={"onClick:close":r,onMousedown(V){V.preventDefault(),V.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},d=t?!!l.chip:!!l.selection,C=d?pe(t?l.chip({item:o,index:f,props:m}):l.selection({item:o,index:f})):void 0;if(!(d&&!C))return s("div",{key:o.value,class:"v-select__selection"},[t?l.chip?s(Ce,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:o.title}}},{default:()=>[C]}):s(we,P({key:"chip",closable:e.closableChips,size:"small",text:o.title,disabled:o.props.disabled},m),null):C??s("span",{class:"v-select__selection-text"},[o.title,e.multiple&&f<u.value.length-1&&s("span",{class:"v-select__selection-comma"},[he(",")])])])})]),"append-inner":function(){var m;for(var o=arguments.length,f=new Array(o),r=0;r<o;r++)f[r]=arguments[r];return s(O,null,[(m=l["append-inner"])==null?void 0:m.call(l,...f),e.menuIcon?s(W,{class:"v-select__menu-icon",icon:e.menuIcon},null):void 0])}})}),Pe({isFocused:g,menu:a,select:I},v)}});export{Ne as V};
