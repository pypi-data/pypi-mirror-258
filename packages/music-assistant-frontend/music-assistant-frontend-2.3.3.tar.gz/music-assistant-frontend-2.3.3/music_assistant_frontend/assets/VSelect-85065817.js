import{m as re,V as $}from"./VTextField-906bd667.js";import{s as Y,w as E,p as Z,aK as ce,aA as de,g as fe,aL as me,r as L,h as q,c as k,aW as ve,l as s,F as O,n as S,aY as pe,R as he,aZ as ye,a_ as j}from"./index-8d784589.js";import{j as ge,c as Ve,V as we}from"./VCheckboxBtn-42f84739.js";import{I as ke,i as be,k as W,E as Ce,F as Pe}from"./forwardRefs-ed349ece.js";import{l as Se,k as xe,n as De,e as Te,b as Ae,V as z,d as Ie}from"./VMenu-017618a3.js";import{V as Fe}from"./VVirtualScroll-1c9015e9.js";function Re(e,B){const l=Y(!1);let h;function m(i){cancelAnimationFrame(h),l.value=!0,h=requestAnimationFrame(()=>{h=requestAnimationFrame(()=>{l.value=!1})})}async function D(){await new Promise(i=>requestAnimationFrame(i)),await new Promise(i=>requestAnimationFrame(i)),await new Promise(i=>requestAnimationFrame(i)),await new Promise(i=>{if(l.value){const a=E(l,()=>{a(),i()})}else i()})}async function T(i){var A,I;if(i.key==="Tab"&&((A=B.value)==null||A.focus()),!["PageDown","PageUp","Home","End"].includes(i.key))return;const a=(I=e.value)==null?void 0:I.$el;if(!a)return;(i.key==="Home"||i.key==="End")&&a.scrollTo({top:i.key==="Home"?0:a.scrollHeight,behavior:"smooth"}),await D();const y=a.querySelectorAll(":scope > :not(.v-virtual-scroll__spacer)");if(i.key==="PageDown"||i.key==="Home"){const u=a.getBoundingClientRect().top;for(const g of y)if(g.getBoundingClientRect().top>=u){g.focus();break}}else{const u=a.getBoundingClientRect().bottom;for(const g of[...y].reverse())if(g.getBoundingClientRect().bottom<=u){g.focus();break}}}return{onListScroll:m,onListKeydown:T}}const Le=Z({chips:Boolean,closableChips:Boolean,closeText:{type:String,default:"$vuetify.close"},openText:{type:String,default:"$vuetify.open"},eager:Boolean,hideNoData:Boolean,hideSelected:Boolean,listProps:{type:Object},menu:Boolean,menuIcon:{type:ce,default:"$dropdown"},menuProps:{type:Object},multiple:Boolean,noDataText:{type:String,default:"$vuetify.noDataText"},openOnClear:Boolean,itemColor:String,...Se({itemChildren:!1})},"Select"),Be=Z({...Le(),...de(re({modelValue:null,role:"combobox"}),["validationValue","dirty","appendInnerIcon"]),...ke({transition:{component:xe}})},"VSelect"),Ne=fe()({name:"VSelect",props:Be(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,"update:menu":e=>!0},setup(e,B){let{slots:l}=B;const{t:h}=me(),m=L(),D=L(),T=L(),i=q(e,"menu"),a=k({get:()=>i.value,set:t=>{var n;i.value&&!t&&((n=D.value)!=null&&n.Î¨openChildren)||(i.value=t)}}),{items:y,transformIn:A,transformOut:I}=De(e),u=q(e,"modelValue",[],t=>A(t===null?[null]:ye(t)),t=>{const n=I(t);return e.multiple?n:n[0]??null}),g=k(()=>typeof e.counterValue=="function"?e.counterValue(u.value):typeof e.counterValue=="number"?e.counterValue:u.value.length),b=ge(),G=k(()=>u.value.map(t=>t.value)),V=Y(!1),K=k(()=>a.value?e.closeText:e.openText);let _="",H;const C=k(()=>e.hideSelected?y.value.filter(t=>!u.value.some(n=>n===t)):y.value),M=k(()=>e.hideNoData&&!C.value.length||e.readonly||(b==null?void 0:b.isReadonly.value)),J=k(()=>{var t;return{...e.menuProps,activatorProps:{...((t=e.menuProps)==null?void 0:t.activatorProps)||{},"aria-haspopup":"listbox"}}}),x=L(),{onListScroll:Q,onListKeydown:X}=Re(x,m);function ee(t){e.openOnClear&&(a.value=!0)}function te(){M.value||(a.value=!a.value)}function le(t){var o,d;if(!t.key||e.readonly||b!=null&&b.isReadonly.value)return;["Enter"," ","ArrowDown","ArrowUp","Home","End"].includes(t.key)&&t.preventDefault(),["Enter","ArrowDown"," "].includes(t.key)&&(a.value=!0),["Escape","Tab"].includes(t.key)&&(a.value=!1),t.key==="Home"?(o=x.value)==null||o.focus("first"):t.key==="End"&&((d=x.value)==null||d.focus("last"));const n=1e3;function f(r){const p=r.key.length===1,c=!r.ctrlKey&&!r.metaKey&&!r.altKey;return p&&c}if(e.multiple||!f(t))return;const v=performance.now();v-H>n&&(_=""),_+=t.key.toLowerCase(),H=v;const R=y.value.find(r=>r.title.toLowerCase().startsWith(_));R!==void 0&&(u.value=[R])}function F(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(e.multiple){const f=u.value.findIndex(v=>e.valueComparator(v.value,t.value));if(n=f===-1,n)u.value=[...u.value,t];else{const v=[...u.value];v.splice(f,1),u.value=v}}else u.value=n?[t]:[],a.value=!1}function ne(t){var n;(n=x.value)!=null&&n.$el.contains(t.relatedTarget)||(a.value=!1)}function ae(){var t;V.value&&((t=m.value)==null||t.focus())}function oe(t){V.value=!0}function ue(t){if(t==null)u.value=[];else if(j(m.value,":autofill")||j(m.value,":-webkit-autofill")){const n=y.value.find(f=>f.title===t);n&&F(n)}else m.value&&(m.value.value="")}return E(a,()=>{if(!e.hideSelected&&a.value&&u.value.length){const t=C.value.findIndex(n=>u.value.some(f=>e.valueComparator(f.value,n.value)));ve&&window.requestAnimationFrame(()=>{var n;t>=0&&((n=T.value)==null||n.scrollToIndex(t))})}}),E(C,(t,n)=>{V.value&&(!t.length&&e.hideNoData&&(a.value=!1),!n.length&&t.length&&(a.value=!0))}),be(()=>{const t=!!(e.chips||l.chip),n=!!(!e.hideNoData||C.value.length||l["prepend-item"]||l["append-item"]||l["no-data"]),f=u.value.length>0,v=$.filterProps(e),R=f||!V.value&&e.label&&!e.persistentPlaceholder?void 0:e.placeholder;return s($,S({ref:m},v,{modelValue:u.value.map(o=>o.props.value).join(", "),"onUpdate:modelValue":ue,focused:V.value,"onUpdate:focused":o=>V.value=o,validationValue:u.externalValue,counterValue:g.value,dirty:f,class:["v-select",{"v-select--active-menu":a.value,"v-select--chips":!!e.chips,[`v-select--${e.multiple?"multiple":"single"}`]:!0,"v-select--selected":u.value.length,"v-select--selection-slot":!!l.selection},e.class],style:e.style,inputmode:"none",placeholder:R,"onClick:clear":ee,"onMousedown:control":te,onBlur:ne,onKeydown:le,"aria-label":h(K.value),title:h(K.value)}),{...l,default:()=>s(O,null,[s(Te,S({ref:D,modelValue:a.value,"onUpdate:modelValue":o=>a.value=o,activator:"parent",contentClass:"v-select__content",disabled:M.value,eager:e.eager,maxHeight:310,openOnClick:!1,closeOnContentClick:!1,transition:e.transition,onAfterLeave:ae},J.value),{default:()=>[n&&s(Ae,S({ref:x,selected:G.value,selectStrategy:e.multiple?"independent":"single-independent",onMousedown:o=>o.preventDefault(),onKeydown:X,onFocusin:oe,onScrollPassive:Q,tabindex:"-1","aria-live":"polite",color:e.itemColor??e.color},e.listProps),{default:()=>{var o,d,r;return[(o=l["prepend-item"])==null?void 0:o.call(l),!C.value.length&&!e.hideNoData&&(((d=l["no-data"])==null?void 0:d.call(l))??s(z,{title:h(e.noDataText)},null)),s(Fe,{ref:T,renderless:!0,items:C.value},{default:p=>{var U;let{item:c,index:P,itemRef:w}=p;const N=S(c.props,{ref:w,key:P,onClick:()=>F(c)});return((U=l.item)==null?void 0:U.call(l,{item:c,index:P,props:N}))??s(z,S(N,{role:"option"}),{prepend:ie=>{let{isSelected:se}=ie;return s(O,null,[e.multiple&&!e.hideSelected?s(Ve,{key:c.value,modelValue:se,ripple:!1,tabindex:"-1"},null):void 0,c.props.prependAvatar&&s(Ie,{image:c.props.prependAvatar},null),c.props.prependIcon&&s(W,{icon:c.props.prependIcon},null)])}})}}),(r=l["append-item"])==null?void 0:r.call(l)]}})]}),u.value.map((o,d)=>{function r(w){w.stopPropagation(),w.preventDefault(),F(o,!1)}const p={"onClick:close":r,onMousedown(w){w.preventDefault(),w.stopPropagation()},modelValue:!0,"onUpdate:modelValue":void 0},c=t?!!l.chip:!!l.selection,P=c?pe(t?l.chip({item:o,index:d,props:p}):l.selection({item:o,index:d})):void 0;if(!(c&&!P))return s("div",{key:o.value,class:"v-select__selection"},[t?l.chip?s(Ce,{key:"chip-defaults",defaults:{VChip:{closable:e.closableChips,size:"small",text:o.title}}},{default:()=>[P]}):s(we,S({key:"chip",closable:e.closableChips,size:"small",text:o.title,disabled:o.props.disabled},p),null):P??s("span",{class:"v-select__selection-text"},[o.title,e.multiple&&d<u.value.length-1&&s("span",{class:"v-select__selection-comma"},[he(",")])])])})]),"append-inner":function(){var p;for(var o=arguments.length,d=new Array(o),r=0;r<o;r++)d[r]=arguments[r];return s(O,null,[(p=l["append-inner"])==null?void 0:p.call(l,...d),e.menuIcon?s(W,{class:"v-select__menu-icon",icon:e.menuIcon},null):void 0])}})}),Pe({isFocused:V,menu:a,select:F},m)}});export{Ne as V};
