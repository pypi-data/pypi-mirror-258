import{formatters,isToday}from"./globals.min.js";const DEBUG="true"==document.body.dataset.debug,BASE_SITE_URL=window.location.protocol+"//"+window.location.hostname+("http:"==window.location.protocol&&80==window.location.port||"https:"==window.location.protocol&&443==window.location.port?"":":"+window.location.port),BASE_STATIC_PATH=document.body.dataset.staticPrefix?document.body.dataset.staticPrefix.replace(/\/$/,""):"/static",BASE_MEDIA_PATH=document.body.dataset.mediaPrefix?document.body.dataset.mediaPrefix.replace(/\/$/,""):"/media",breakpoint={xs:0,sm:576,md:768,lg:992,xl:1200,xxl:1400};function fromHTML(e){var t=document.createElement("template"),e=(t.innerHTML=e,t.content.children);return 1==e.length?e[0]:e}function submitLoading(e,{data:t,url:s,json:o,successMessage:a,onSuccess:n}={}){var r=new FormData(e);if(t)for(const c in t)r.set(c,t[c]);s=s||e.getAttribute("action");let i;i="post"==e.method?{method:"post",body:r}:(s+="?"+new URLSearchParams(r),{method:"get"});const d=e.querySelector('button[type="submit"]'),l=d.innerHTML;d.innerHTML='<span class="spinner-border spinner-border-sm" aria-hidden="true"></span><span class="visually-hidden" role="status">Loading...</span>',d.disabled=!0,fetch(s,i).then(t=>{(o?t.json():t.text()).then(e=>{a&&messages.add(t.ok?"SUCCESS":"ERROR",e),n&&t.ok&&n(e)}).catch(e=>messages.error(e))}).catch(e=>{messages.error(e)}).finally(()=>{d.innerHTML=l,d.disabled=!1})}function initBootstrapTable(s,{fields:e,sortName:t,sortOrder:o,pageSize:a,columns:n,...r}={}){var i=document.getElementById(s),d=(void 0===r.pagination&&(r.pagination=!0),void 0===r.search&&(r.search=!0),void 0===r.toolbar&&(r.toolbar=`#${s}-toolbar`),r.sortName=localStorage.getItem(`bt-${s}-sortName`)??t,r.sortOrder=localStorage.getItem(`bt-${s}-sortOrder`)??o??"asc",r.onSort=(e,t)=>{localStorage.setItem(`bt-${s}-sortName`,e),localStorage.setItem(`bt-${s}-sortOrder`,t)},r.pageSize=localStorage.getItem(`bt-${s}-pageSize`)??a??25,r.onPageChange=(e,t)=>{localStorage.setItem(`bt-${s}-pageSize`,t)},void 0===n&&(n=[]),{});if(i.tHead)for(var[l,c]of i.tHead.querySelectorAll("th").entries()){c=c.dataset.field;c&&(d[c]=l),n.length<l+1&&n.push({})}for(const u of n)void 0===u.sortable&&(u.sortable=!0);if(e)for(var[m,g]of Object.entries(e)){var h=d[m];void 0===h?console.error(`${s}: ignore column configuration for field "${m}": field not found in thead`):n[h]={...n[h],...g}}return $("#"+s).bootstrapTable({columns:n,...r})}const _messages=document.getElementById("messages");let _messagesCloseAll,_messagesContent,_messagesFixedAfter;const messages={add(e,t){let s="primary";if(e)switch(e.toUpperCase()){case"DEBUG":s="secondary";break;case"INFO":s="info";break;case"SUCCESS":s="success";break;case"WARNING":s="warning";break;case"ERROR":s="danger"}e=fromHTML(`<div class="alert alert-${s} alert-dismissible fade show" role="alert">${t}<button type="button" class="btn-close" data-bs-dismiss="alert"></button></div>`);return _messagesContent.appendChild(e),0<_messagesFixedAfter&&window.scrollY>_messagesFixedAfter&&_messages.classList.add("fixed-messages"),e},clear(){for(;_messagesContent.firstChild;)_messagesContent.removeChild(_messagesContent.lastChild);_messagesCloseAll&&_messagesCloseAll.classList.add("d-none")},debug(e){return this.add("DEBUG",e)},info(e){return this.add("INFO",e)},success(e){return this.add("SUCCESS",e)},warning(e){return this.add("WARNING",e)},error(e){return this.add("ERROR",e)}};function _onUpdate(){2<=_messagesContent.childElementCount?_messagesCloseAll.classList.remove("d-none"):(_messagesCloseAll.classList.add("d-none"),0<_messagesFixedAfter&&0==_messagesContent.childElementCount&&_messages.classList.remove("fixed-messages"))}function initShowHide(t){const s=document.getElementById(t.dataset.showhide);if(s){const n=fromHTML("<i></i>"),r=fromHTML('<a href="#" class="ms-2 text-dark"></a>');r.appendChild(n),t.appendChild(r);let e;var o=localStorage.getItem(`showhide-${t.dataset.showhide}-hidden`);function a(e){localStorage.setItem(`showhide-${t.dataset.showhide}-hidden`,e?"1":"0"),e?(n.className="bi-toggle-off",r.title="Show"):(n.className="bi-toggle-on",r.title="Hide")}o?(e="1"==o)?s.classList.add("d-none"):s.classList.remove("d-none"):e=s.classList.contains("d-none"),a(e),r.addEventListener("click",e=>{a(s.classList.toggle("d-none")),e.preventDefault()})}else console.error(`showhide content with id "${t.dataset.showhide}" not found`)}_messages&&(_messagesFixedAfter=parseInt(document.body.dataset.messagesFixedAfter??75),_messagesContent=document.getElementById("messages-content")??_messages,_messagesCloseAll=document.getElementById("messages-close-all"))&&(_messagesCloseAll.querySelector("a").addEventListener("click",e=>{e.preventDefault(),messages.clear()}),new MutationObserver(_onUpdate).observe(_messagesContent,{childList:!0}),_onUpdate());export{formatters,isToday,DEBUG,BASE_SITE_URL,BASE_STATIC_PATH,BASE_MEDIA_PATH,breakpoint,fromHTML,submitLoading,initBootstrapTable,messages,initShowHide};
//# sourceMappingURL=index.min.js.map