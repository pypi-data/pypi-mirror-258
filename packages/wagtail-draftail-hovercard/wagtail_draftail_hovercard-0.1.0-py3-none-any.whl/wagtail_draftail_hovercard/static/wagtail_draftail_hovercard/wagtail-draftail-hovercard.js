(function(n){typeof define=="function"&&define.amd?define(n):n()})(function(){"use strict";function n(){const t=document.getElementById("wagtail-draftail-hovercard-settings");try{return JSON.parse(t.textContent)}catch(e){return console.error("Failed to parse wagtail-draftail-hovercard settings",e),{}}}const c={choose(t,e){t.ajaxifyForm(t.body.find("form"))},chosen(t,e){t.respond("chosen",e.result),t.close()}};class i extends window.draftail.ModalWorkflowSource{getChooserConfig(e,o){const a=n().hovercardModalUrl,r={selectedText:o,heading:e&&e.data.heading||"",text:e&&e.data.text||""};return{url:a,urlParams:r,onload:c,responses:{chosen:this.onChosen}}}filterEntityData(e){return{heading:e.heading,text:e.text}}render(){return null}}const{TooltipEntity:s}=window.draftail,{Icon:d}=window.wagtail.components,l=t=>{const{entityKey:e,contentState:o}=t,a=o.getEntity(e).getData().heading||"Hovercard",r=window.React.createElement(d,{name:"tag"});return window.React.createElement(s,{icon:r,label:a,...t})};window.draftail.registerPlugin({type:"HOVERCARD",source:i,decorator:l},"entityTypes")});
