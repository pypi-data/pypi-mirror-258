!function(e,n){"function"==typeof define&&define.amd?define(["elfinder"],n):"undefined"!=typeof exports?module.exports=n(require("elfinder")):n(e.elFinder)}(this,function(e){"use strict";try{e.prototype.commands.quicklook.plugins||(e.prototype.commands.quicklook.plugins=[]),e.prototype.commands.quicklook.plugins.push(function(r){var a=r.fm,t=r.preview;t.on("update",function(e){r.window;var n,o,i=e.file;0===i.mime.indexOf("application/vnd.google-apps.")&&("1"==i.url&&(t.hide(),$('<div class="elfinder-quicklook-info-data"><button class="elfinder-info-button">'+a.i18n("getLink")+"</button></div>").appendTo(r.info.find(".elfinder-quicklook-info")).on("click",function(){$(this).html('<span class="elfinder-spinner">'),a.request({data:{cmd:"url",target:i.hash},preventDefault:!0}).always(function(){t.show(),$(this).html("")}).done(function(e){var n=a.file(i.hash);r.value.url=n.url=e.url||"",r.value.url&&t.trigger($.Event("update",{file:r.value}))})})),""!==i.url)&&"1"!=i.url&&(e.stopImmediatePropagation(),o=$('<div class="elfinder-quicklook-info-data"><span class="elfinder-spinner-text">'+a.i18n("nowLoading")+'</span><span class="elfinder-spinner"></span></div>').appendTo(r.info.find(".elfinder-quicklook-info")),n=$('<iframe class="elfinder-quicklook-preview-iframe"></iframe>').css("background-color","transparent").on("load",function(){r.hideinfo(),o.remove(),n.css("background-color","#fff")}).on("error",function(){o.remove(),n.remove()}).appendTo(t).attr("src",a.url(i.hash)),t.one("change",function(){o.remove(),n.off("load").remove()}))})})}catch(e){}});