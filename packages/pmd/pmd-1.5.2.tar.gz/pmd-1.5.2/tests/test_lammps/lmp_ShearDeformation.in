# LAMMPS input file generated by PMD package

### Initialization
atom_style      full
units           real

pair_style      lj/cut/coul/long 12.0 12.0
pair_modify     mix arithmetic
kspace_style    pppm 1e-4
bond_style      harmonic
angle_style     harmonic
dihedral_style  fourier
improper_style  cvff
special_bonds   amber

read_data       data.lmps

neighbor        2.0 bin
neigh_modify    delay 0 every 1 check yes

thermo_style    custom step temp density vol press ke pe ebond evdwl ecoul elong
thermo          1000
timestep        1


### Minimization
min_style       cg
minimize        1e-08 1e-10 10000000 1000000000


### Equilibration
reset_timestep  0

dump            dump_Equilibration all custom 10000 equil.lammpstrj id mol type q xs ys zs ix iy iz
restart         1560000 Equilibration.restart

fix             fLANGEVIN all langevin 800 800 $(100.0*dt) 723853
fix             fNVELIMIT all nve/limit 0.1
fix             fMOM all momentum 100 linear 1 1 1 angular
run             10000

unfix           fLANGEVIN
unfix           fNVELIMIT
unfix           fMOM

reset_timestep  0

fix             step1 all nvt temp 800 800 $(100.0*dt)
run             50000
unfix           step1

fix             step2 all nvt temp 300 300 $(100.0*dt)
run             50000
unfix           step2

fix             step3 all npt temp 300 300 $(100.0*dt) iso 986.92326 986.92326 $(100.0*dt)
run             50000
unfix           step3

fix             step4 all nvt temp 800 800 $(100.0*dt)
run             50000
unfix           step4

fix             step5 all nvt temp 300 300 $(100.0*dt)
run             100000
unfix           step5

fix             step6 all npt temp 300 300 $(100.0*dt) iso 29607.697799999998 29607.697799999998 $(100.0*dt)
run             50000
unfix           step6

fix             step7 all nvt temp 800 800 $(100.0*dt)
run             50000
unfix           step7

fix             step8 all nvt temp 300 300 $(100.0*dt)
run             100000
unfix           step8

fix             step9 all npt temp 300 300 $(100.0*dt) iso 49346.163 49346.163 $(100.0*dt)
run             50000
unfix           step9

fix             step10 all nvt temp 800 800 $(100.0*dt)
run             50000
unfix           step10

fix             step11 all nvt temp 300 300 $(100.0*dt)
run             100000
unfix           step11

fix             step12 all npt temp 300 300 $(100.0*dt) iso 24673.0815 24673.0815 $(100.0*dt)
run             5000
unfix           step12

fix             step13 all nvt temp 800 800 $(100.0*dt)
run             5000
unfix           step13

fix             step14 all nvt temp 300 300 $(100.0*dt)
run             10000
unfix           step14

fix             step15 all npt temp 300 300 $(100.0*dt) iso 4934.616300000001 4934.616300000001 $(100.0*dt)
run             5000
unfix           step15

fix             step16 all nvt temp 800 800 $(100.0*dt)
run             5000
unfix           step16

fix             step17 all nvt temp 300 300 $(100.0*dt)
run             10000
unfix           step17

fix             step18 all npt temp 300 300 $(100.0*dt) iso 493.46163 493.46163 $(100.0*dt)
run             5000
unfix           step18

fix             step19 all nvt temp 800 800 $(100.0*dt)
run             5000
unfix           step19

fix             step20 all nvt temp 300 300 $(100.0*dt)
run             10000
unfix           step20

fix             step21 all npt temp 300 300 $(100.0*dt) iso 1 1 $(100.0*dt)
run             800000
unfix           step21

undump          dump_Equilibration


### ShearDeformation
reset_timestep  0

change_box      all triclinic
kspace_style    pppm 1e-4  # must redefine pppm after changing to triclinic

dump            dump_ShearDeformation all custom 10000 shear_deformation.lammpstrj id mol type q xs ys zs ix iy iz
restart         10000000 ShearDeformation.restart

variable        srate_in_s equal 1  # shear rate [1/s]
variable        srate equal ${srate_in_s}/1e15  # convert shear rate unit from 1/s to 1/fs

fix             fNVTSLLOD all nvt/sllod temp 300 300 $(100.0*dt)
fix             fDEFORM all deform 1 xy erate ${srate} remap v

compute         tdeform all temp/deform  # calculate temperautre by subtracting out a streaming velocity induced by deformation
compute         pdeform all pressure tdeform
thermo_modify   temp tdeform
thermo_modify   press pdeform
variable        stress equal (-1)*c_pdeform[4] # -pxy
variable        visc equal 1.01325e-10*v_stress/(v_srate)  # shear viscosity [Pa s]; first term is unit converter
fix             fVISC all ave/time 100 1000 100000 v_visc ave one file viscosity.txt
run             10000000

unfix           fNVTSLLOD
unfix           fDEFORM
unfix           fVISC

undump          dump_ShearDeformation
