import{_ as b}from"./index.774a66f5.js";import{ah as a,o as c,c as d,V as r,P as l,a as f,T as y,U as g,F as v,a8 as k,S as w}from"./vendor-vue.cefe3aef.js";import{e as x}from"./element-plus.af689926.js";import{i as C,p as V,c as S}from"./vendor-lib.a8c0b8df.js";import"./element-icon.1fe9d2a8.js";const D={mail_host:[{message:"\u670D\u52A1\u5668\u5730\u5740\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}],mail_port:[{message:"\u670D\u52A1\u5668\u7AEF\u53E3\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}],mail_alias:[{message:"\u53D1\u4EF6\u4EBA\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",required:!1,trigger:"blur"}],mail_username:[{message:"\u53D1\u4EF6\u4EBA\u8D26\u53F7\u4E0D\u80FD\u4E3A\u7A7A",required:!1,trigger:"blur"}],mail_password:[{message:"\u53D1\u4EF6\u4EBA\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A",required:!1,trigger:"blur"}]},E={name:"",props:{row:{type:Object,default:null}},components:{},data(){return{rules:D,form:{mail_host:"",mail_port:"",mail_alias:"",mail_username:"",mail_password:""}}},computed:{},methods:{async getData(){let e={};const t=await this.$http.getAllSystemConfig(e);if(t.code!=0)return;let s=t.data;this.form.mail_host=s.mail_host,this.form.mail_port=s.mail_port,this.form.mail_alias=s.mail_alias,this.form.mail_username=s.mail_username,this.form.mail_password=s.mail_password},handleCancel(){this.$emit("on-cancel")},handleSubmit(){this.$refs.form.validate(e=>{if(e)this.confirmSubmit();else return!1})},async confirmSubmit(){let e=this.$loading({fullscreen:!0}),t={mail_host:this.form.mail_host,mail_port:this.form.mail_port,mail_alias:this.form.mail_alias,mail_username:this.form.mail_username,mail_password:this.form.mail_password};const s=await this.$http.updateSystemConfig(t);s.code==0?(this.$msg.success("\u64CD\u4F5C\u6210\u529F"),this.$emit("on-success")):this.$msg.error(s.msg),this.$nextTick(()=>{e.close()})}},created(){this.getData()}},N={class:""},F={class:"text-center"};function T(e,t,s,h,o,u){const m=a("el-input"),i=a("el-form-item"),p=a("el-form"),_=a("el-button");return c(),d("div",N,[r(p,{ref:"form",model:o.form,rules:o.rules,"label-width":"100px"},{default:l(()=>[r(i,{label:e.$t("\u670D\u52A1\u5668\u5730\u5740"),prop:"mail_host"},{default:l(()=>[r(m,{type:"text",modelValue:o.form.mail_host,"onUpdate:modelValue":t[0]||(t[0]=n=>o.form.mail_host=n),placeholder:"\u8BF7\u8F93\u5165\u670D\u52A1\u5668\u5730\u5740"},null,8,["modelValue"])]),_:1},8,["label"]),r(i,{label:e.$t("\u670D\u52A1\u5668\u7AEF\u53E3"),prop:"mail_port"},{default:l(()=>[r(m,{type:"text",modelValue:o.form.mail_port,"onUpdate:modelValue":t[1]||(t[1]=n=>o.form.mail_port=n),placeholder:"\u8BF7\u8F93\u5165\u670D\u52A1\u5668\u7AEF\u53E3"},null,8,["modelValue"])]),_:1},8,["label"]),r(i,{label:e.$t("\u53D1\u4EF6\u4EBA\u540D\u79F0"),prop:"mail_alias"},{default:l(()=>[r(m,{type:"text",modelValue:o.form.mail_alias,"onUpdate:modelValue":t[2]||(t[2]=n=>o.form.mail_alias=n),placeholder:"\u8BF7\u8F93\u5165\u53D1\u4EF6\u4EBA\u540D\u79F0"},null,8,["modelValue"])]),_:1},8,["label"]),r(i,{label:e.$t("\u53D1\u4EF6\u4EBA\u8D26\u53F7"),prop:"mail_username"},{default:l(()=>[r(m,{type:"text",modelValue:o.form.mail_username,"onUpdate:modelValue":t[3]||(t[3]=n=>o.form.mail_username=n),placeholder:"\u8BF7\u8F93\u5165\u53D1\u4EF6\u4EBA\u8D26\u53F7"},null,8,["modelValue"])]),_:1},8,["label"]),r(i,{label:e.$t("\u53D1\u4EF6\u4EBA\u5BC6\u7801"),prop:"mail_password"},{default:l(()=>[r(m,{type:"text",modelValue:o.form.mail_password,"onUpdate:modelValue":t[4]||(t[4]=n=>o.form.mail_password=n),placeholder:"\u8BF7\u8F93\u5165\u53D1\u4EF6\u4EBA\u5BC6\u7801","show-password":""},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"]),f("div",F,[r(_,{type:"primary",onClick:u.handleSubmit},{default:l(()=>[y(g(e.$t("\u4FDD\u5B58")),1)]),_:1},8,["onClick"])])])}const q=b(E,[["render",T]]),U={scheduler_cron:[{message:"\u5B9A\u65F6\u68C0\u6D4B\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"},{trigger:"blur",validator:(e,t,s)=>{if(C(t))s();else return s(new Error("cron\u8868\u8FBE\u5F0F\u4E0D\u6B63\u786E"))}}]};function L(e){if(!C(e))return[];let t=[];try{let s=V.parseExpression(e);for(let h=0;h<5;h++){let o=x(s.next().toString()).format("YYYY-MM-DD HH:mm:ss");t.push(o)}}catch{}return t}const Y={name:"",props:{row:{type:Object,default:null}},components:{},data(){return{rules:U,form:{scheduler_cron:""},cronNextList:[]}},computed:{},methods:{async getData(){let e={};const t=await this.$http.getCronConfig(e);if(t.code!=0)return;let s=t.data;this.form.scheduler_cron=s.scheduler_cron,this.parseCrontab()},handleCancel(){this.$emit("on-cancel")},handleSubmit(){this.$refs.form.validate(e=>{if(e)this.confirmSubmit();else return!1})},async confirmSubmit(){let e=this.$loading({fullscreen:!0}),t={scheduler_cron:this.form.scheduler_cron};this.row&&(t.id=this.row.id);const s=await this.$http.updateCronConfig(t);s.code==0?(this.$msg.success("\u64CD\u4F5C\u6210\u529F"),this.$emit("on-success")):this.$msg.error(s.msg),this.$nextTick(()=>{e.close()})},parseCrontab(){this.cronNextList=L(this.form.scheduler_cron)}},created(){this.getData()}},j={key:0},I={key:1,class:"mo-empty"},z={class:"text-center"};function B(e,t,s,h,o,u){const m=a("el-input"),i=a("el-form-item"),p=a("el-form"),_=a("el-button");return c(),d("div",null,[r(p,{ref:"form",model:o.form,rules:o.rules,"label-width":"100px"},{default:l(()=>[r(i,{label:e.$t("\u5B9A\u65F6\u8BBE\u7F6E"),prop:"scheduler_cron"},{default:l(()=>[r(m,{type:"text",modelValue:o.form.scheduler_cron,"onUpdate:modelValue":t[0]||(t[0]=n=>o.form.scheduler_cron=n),onChange:u.parseCrontab,placeholder:"crontab \u8868\u8FBE\u5F0F\uFF1A\u5206 \u65F6 \u65E5 \u6708 \u5468"},null,8,["modelValue","onChange"])]),_:1},8,["label"]),r(i,{label:e.$t("\u6267\u884C\u8BA1\u5212"),prop:"cronNextList"},{default:l(()=>[o.cronNextList&&o.cronNextList.length>0?(c(),d("div",j,[(c(!0),d(v,null,k(o.cronNextList,n=>(c(),d("div",null,g(n),1))),256))])):(c(),d("div",I," \u6682\u65E0\u8BA1\u5212 "))]),_:1},8,["label"])]),_:1},8,["model","rules"]),f("div",z,[r(_,{type:"primary",onClick:u.handleSubmit},{default:l(()=>[y(g(e.$t("\u4FDD\u5B58")),1)]),_:1},8,["onClick"])])])}const O=b(Y,[["render",B]]),P={prometheus_key:[{message:"prometheus_key\u4E0D\u80FD\u4E3A\u7A7A",required:!1,trigger:"blur"}],token_expire_days:[{message:"Token\u6709\u6548\u671F\uFF08\u5929\uFF09\u4E0D\u80FD\u4E3A\u7A7A",required:!1,trigger:"blur"}]},R={name:"",props:{row:{type:Object,default:null}},components:{},data(){return{rules:P,form:{prometheus_key:"",token_expire_days:""}}},computed:{},methods:{async getData(){let e={};const t=await this.$http.getSystemEnvConfig(e);if(t.code!=0)return;let s=t.data;this.form.prometheus_key=s.prometheus_key,this.form.token_expire_days=s.token_expire_days},handleCancel(){this.$emit("on-cancel")},handleSubmit(){this.$refs.form.validate(e=>{if(e)this.confirmSubmit();else return!1})},async confirmSubmit(){let e=this.$loading({fullscreen:!0}),t={prometheus_key:this.form.prometheus_key,token_expire_days:this.form.token_expire_days};this.row&&(t.id=this.row.id);const s=await this.$http.function(t);s.code==0?(this.$msg.success("\u64CD\u4F5C\u6210\u529F"),this.$emit("on-success")):this.$msg.error(s.msg),this.$nextTick(()=>{e.close()})},handleCopyClick(e){S(e),this.$msg.success("\u5DF2\u590D\u5236\u5230\u526A\u5207\u677F")}},created(){this.getData()}};function A(e,t,s,h,o,u){const m=a("DocumentCopy"),i=a("el-icon"),p=a("el-form-item"),_=a("el-form");return a("el-button"),c(),d("div",null,[r(_,{ref:"form",model:o.form,rules:o.rules,"label-width":"150px","aria-label":"left"},{default:l(()=>[r(p,{label:"Prometheus Key",prop:"prometheus_key"},{default:l(()=>[f("span",null,g(o.form.prometheus_key),1),f("span",{onClick:t[0]||(t[0]=n=>u.handleCopyClick(o.form.prometheus_key)),class:"mo-link ml-sm"},[r(i,null,{default:l(()=>[r(m)]),_:1})])]),_:1})]),_:1},8,["model","rules"]),w("",!0)])}const H=b(R,[["render",A]]);const K={name:"index",props:{},components:{SystemEditDataForm:q,CronConfigEditDataForm:O,SystemEnvEditDataForm:H},data(){return{activeName:"email-config"}},computed:{},methods:{async getData(){},handleTabChange(e){localStorage.setItem("system-setup/tab",e)}},created(){let e=localStorage.getItem("system-setup/tab");this.activeName=this.$route.query.tab||e||this.activeName,this.getData()}},M={class:"app-container"},G={class:"tab-container"},J={class:"tab-container"},Q={class:"tab-container"};function W(e,t,s,h,o,u){const m=a("SystemEditDataForm"),i=a("el-tab-pane"),p=a("CronConfigEditDataForm"),_=a("SystemEnvEditDataForm"),n=a("el-tabs");return c(),d("div",M,[r(n,{modelValue:o.activeName,"onUpdate:modelValue":t[0]||(t[0]=$=>o.activeName=$),onTabChange:u.handleTabChange},{default:l(()=>[r(i,{label:e.$t("\u90AE\u4EF6\u8BBE\u7F6E"),name:"email-config",lazy:""},{default:l(()=>[f("div",G,[r(m)])]),_:1},8,["label"]),r(i,{label:e.$t("\u76D1\u6D4B\u8BBE\u7F6E"),name:"cron-config",lazy:""},{default:l(()=>[f("div",J,[r(p)])]),_:1},8,["label"]),r(i,{label:"API KEY",name:"system-env",lazy:""},{default:l(()=>[f("div",Q,[r(_)])]),_:1})]),_:1},8,["modelValue","onTabChange"])])}const se=b(K,[["render",W],["__scopeId","data-v-63953fa2"]]);export{se as default};
